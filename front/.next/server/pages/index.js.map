{"version":3,"file":"../pages/index.js","mappings":"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","sources":["webpack://react-social-app/./components/PostForm.tsx","webpack://react-social-app/./pages/index.tsx","webpack://react-social-app/external commonjs \"@ant-design/icons\"","webpack://react-social-app/external commonjs \"axios\"","webpack://react-social-app/external commonjs \"next-redux-wrapper\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/head-manager-context.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/i18n/normalize-locale-path.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/is-plain-object.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/mitt.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/page-path/denormalize-page-path.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router-context.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/format-url.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/get-middleware-regex.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/is-dynamic.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/parse-relative-url.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/querystring.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/resolve-rewrites.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/route-matcher.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/route-regex.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/utils.js\"","webpack://react-social-app/external commonjs \"next/head\"","webpack://react-social-app/external commonjs \"next/router\"","webpack://react-social-app/external commonjs \"react\"","webpack://react-social-app/external commonjs \"react-redux\"","webpack://react-social-app/external commonjs \"react-slick\"","webpack://react-social-app/external commonjs \"react/jsx-runtime\"","webpack://react-social-app/external commonjs \"redux\"","webpack://react-social-app/external commonjs \"redux-devtools-extension\"","webpack://react-social-app/external commonjs \"redux-saga\"","webpack://react-social-app/external commonjs \"redux-saga/effects\"","webpack://react-social-app/external commonjs \"tailwind-styled-components\"","webpack://react-social-app/external module \"immer\"","webpack://react-social-app/external module \"react-hook-form\"","webpack://react-social-app/external module \"react-intersection-observer\""],"sourcesContent":["import { DeleteOutlined, PlusSquareOutlined } from \"@ant-design/icons\";\r\nimport React, { useCallback, useRef } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport tw from \"tailwind-styled-components\";\r\nimport {\r\n  addPostRequestAction,\r\n  postImageDeleteAction,\r\n  postImageUploadRequestAction,\r\n} from \"../action/postActions\";\r\nimport { myInfoLoadRequestAction } from \"../action/userAction\";\r\nimport { RootState } from \"../reducers\";\r\n\r\nconst Wrapper = tw.div`\r\n  max-w-sm\r\n  mx-auto\r\n  sm:max-w-md\r\n  mt-10\r\n`;\r\n\r\nconst FormContainer = tw.form`\r\n  space-y-1\r\n`;\r\n\r\nconst TextArea = tw.textarea`\r\n  w-full\r\n  p-2\r\n  focus:outline-none\r\n  focus:ring-2\r\n  focus:ring-indigo-500\r\n  rounded-md\r\n  border-[1px]\r\n  border-gray-400\r\n  \r\n`;\r\n\r\nconst SubmitButtonContainer = tw.div`\r\n  flex\r\n  items-center\r\n  justify-between\r\n`;\r\n\r\nconst SubmitButton = tw.button`\r\n  bg-indigo-400\r\n  hover:bg-indigo-600\r\n  text-white\r\n  p-2\r\n  px-4\r\n  rounded-md\r\n`;\r\n\r\nconst PlusPhoto = tw(PlusSquareOutlined)`\r\n  text-indigo-400\r\n  hover:text-indigo-700\r\n  text-3xl\r\n  cursor-pointer\r\n`;\r\n\r\nconst ImageInput = tw.input`\r\n  hidden\r\n`;\r\n\r\nconst PreImage = tw.img`\r\n  w-28\r\n  h-28\r\n  bg-cover\r\n`;\r\n\r\ninterface ValidForm {\r\n  content: string;\r\n}\r\n\r\nfunction PostForm() {\r\n  const { imagePaths } = useSelector((state: RootState) => state.postReducer);\r\n  const dispatch = useDispatch();\r\n  const photoInput = useRef<HTMLInputElement>();\r\n  const { register, handleSubmit, reset } = useForm<ValidForm>();\r\n  const onClickPhoto = useCallback(() => {\r\n    photoInput.current.click();\r\n  }, [photoInput.current]);\r\n  const onValid = ({ content }: ValidForm) => {\r\n    if (!imagePaths) {\r\n      dispatch(addPostRequestAction({ content }));\r\n    } else {\r\n      const formData = new FormData();\r\n      imagePaths.forEach((image) => {\r\n        formData.append(\"image\", image);\r\n      });\r\n      formData.append(\"content\", content);\r\n      dispatch(addPostRequestAction(formData));\r\n    }\r\n    reset();\r\n  };\r\n  const onChangePhoto = (e) => {\r\n    const formData = new FormData();\r\n    [].forEach.call(e.target.files, (file) => {\r\n      formData.append(\"postimg\", file);\r\n    });\r\n    dispatch(postImageUploadRequestAction(formData));\r\n    e.target.value = \"\";\r\n  };\r\n  const onClickPostImgDelete = (index) => {\r\n    dispatch(postImageDeleteAction(index));\r\n  };\r\n\r\n  return (\r\n    <Wrapper>\r\n      <FormContainer\r\n        onSubmit={handleSubmit(onValid)}\r\n        encType=\"multipart/form-data\"\r\n      >\r\n        <TextArea {...register(\"content\")} rows={4} />\r\n        <SubmitButtonContainer>\r\n          <PlusPhoto onClick={onClickPhoto} />\r\n          <ImageInput\r\n            multiple\r\n            type=\"file\"\r\n            ref={photoInput}\r\n            name=\"postimg\"\r\n            accept=\"image/*\"\r\n            onChange={onChangePhoto}\r\n          />\r\n          <SubmitButton>짹짹</SubmitButton>\r\n        </SubmitButtonContainer>\r\n      </FormContainer>\r\n      <div>\r\n        {imagePaths.length !== 0 ? (\r\n          <div className=\"flex px-2 items-center space-x-2 mt-2 overflow-auto scrollbar-thin  scrollbar-thumb-gray-400 scrollbar-track-gray-100\">\r\n            {imagePaths.map((image) => (\r\n              <div key={image} className=\"h-36 w-28 min-w-max mb-2\">\r\n                <PreImage src={`http://localhost:4000/${image}`} />\r\n                <button\r\n                  onClick={() => onClickPostImgDelete(image)}\r\n                  className=\"text-lg text-gray-400 hover:text-red-500\"\r\n                >\r\n                  <DeleteOutlined />\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n    </Wrapper>\r\n  );\r\n}\r\n\r\nexport default PostForm;\r\n","import Head from \"next/head\";\r\nimport React, { useEffect } from \"react\";\r\nimport Layout from \"../components/Layout\";\r\nimport PostCard from \"../components/PostCard\";\r\nimport MyProfile from \"../components/MyProfile\";\r\nimport tw from \"tailwind-styled-components\";\r\nimport PostForm from \"../components/PostForm\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../reducers\";\r\nimport { END } from \"redux-saga\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { myInfoLoadRequestAction } from \"../action/userAction\";\r\nimport { useInView } from \"react-intersection-observer\";\r\nimport { postLoadRequestAction } from \"../action/postActions\";\r\nimport wrapper from \"../store/configureStore\";\r\nimport axios from \"axios\";\r\nimport { GetServerSideProps } from \"next\";\r\n\r\nconst Wrapper = tw.div`\r\n  flex-col\r\n  relative\r\n`;\r\n\r\nconst Home = () => {\r\n  const [ref, inView] = useInView();\r\n\r\n  const dispatch = useDispatch();\r\n  const { me } = useSelector((state: RootState) => state.userReducer);\r\n  const {\r\n    postDeleteDone,\r\n    addPostDone,\r\n    mainPosts,\r\n    postLoadLoading,\r\n    hasMorePosts,\r\n  } = useSelector((state: RootState) => state.postReducer);\r\n\r\n  useEffect(() => {\r\n    if (inView && hasMorePosts && !postLoadLoading) {\r\n      const lastId = mainPosts[mainPosts.length - 1]?.id;\r\n\r\n      dispatch(postLoadRequestAction(lastId));\r\n    }\r\n  }, [inView, mainPosts, hasMorePosts, postLoadLoading]);\r\n\r\n  useEffect(() => {\r\n    if (addPostDone) {\r\n      dispatch(myInfoLoadRequestAction());\r\n    }\r\n    if (postDeleteDone) {\r\n      dispatch(myInfoLoadRequestAction());\r\n    }\r\n  }, [addPostDone, postDeleteDone]);\r\n\r\n  return (\r\n    <>\r\n      <Head>\r\n        <meta charSet=\"UTF-8\" />\r\n        <title>Social Service</title>\r\n      </Head>\r\n      <Layout>\r\n        <Wrapper>\r\n          {me ? <MyProfile /> : null}\r\n          {me && <PostForm />}\r\n          {mainPosts?.map((post) => (\r\n            <PostCard key={post?.id} {...post} />\r\n          ))}\r\n          <div\r\n            className=\"h-3\"\r\n            ref={hasMorePosts && !postLoadLoading ? ref : undefined}\r\n          />\r\n        </Wrapper>\r\n      </Layout>\r\n    </>\r\n  );\r\n};\r\n\r\nexport const getServerSideProps: GetServerSideProps =\r\n  wrapper.getServerSideProps((store) => async (context) => {\r\n    const cookie = context.req ? context.req.headers.cookie : \"\";\r\n    axios.defaults.headers.common.Cookie = \"\";\r\n    if (context.req && cookie) {\r\n      axios.defaults.headers.common.Cookie = cookie;\r\n    }\r\n\r\n    store.dispatch(myInfoLoadRequestAction());\r\n    store.dispatch(postLoadRequestAction(0));\r\n\r\n    store.dispatch(END);\r\n    await store.sagaTask.toPromise();\r\n    return {\r\n      props: {},\r\n    };\r\n  });\r\n\r\nexport default Home;\r\n","module.exports = require(\"@ant-design/icons\");","module.exports = require(\"axios\");","module.exports = require(\"next-redux-wrapper\");","module.exports = require(\"next/dist/shared/lib/head-manager-context.js\");","module.exports = require(\"next/dist/shared/lib/i18n/normalize-locale-path.js\");","module.exports = require(\"next/dist/shared/lib/is-plain-object.js\");","module.exports = require(\"next/dist/shared/lib/mitt.js\");","module.exports = require(\"next/dist/shared/lib/page-path/denormalize-page-path.js\");","module.exports = require(\"next/dist/shared/lib/router-context.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/format-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-middleware-regex.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/is-dynamic.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/parse-relative-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/querystring.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/resolve-rewrites.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-matcher.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-regex.js\");","module.exports = require(\"next/dist/shared/lib/utils.js\");","module.exports = require(\"next/head\");","module.exports = require(\"next/router\");","module.exports = require(\"react\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-slick\");","module.exports = require(\"react/jsx-runtime\");","module.exports = require(\"redux\");","module.exports = require(\"redux-devtools-extension\");","module.exports = require(\"redux-saga\");","module.exports = require(\"redux-saga/effects\");","module.exports = require(\"tailwind-styled-components\");","module.exports = import(\"immer\");;","module.exports = import(\"react-hook-form\");;","module.exports = import(\"react-intersection-observer\");;"],"names":["DeleteOutlined","PlusSquareOutlined","React","useCallback","useRef","useForm","useSelector","useDispatch","tw","addPostRequestAction","postImageDeleteAction","postImageUploadRequestAction","Wrapper","div","FormContainer","form","TextArea","textarea","SubmitButtonContainer","SubmitButton","button","PlusPhoto","ImageInput","input","PreImage","img","PostForm","imagePaths","state","postReducer","dispatch","photoInput","register","handleSubmit","reset","onClickPhoto","current","click","onValid","content","formData","FormData","forEach","image","append","onChangePhoto","e","call","target","files","file","value","onClickPostImgDelete","index","onSubmit","encType","rows","onClick","multiple","type","ref","name","accept","onChange","length","className","map","src","Head","useEffect","Layout","PostCard","MyProfile","END","myInfoLoadRequestAction","useInView","postLoadRequestAction","wrapper","axios","Home","inView","me","userReducer","postDeleteDone","addPostDone","mainPosts","postLoadLoading","hasMorePosts","lastId","id","meta","charSet","title","post","undefined","getServerSideProps","store","context","cookie","req","headers","defaults","common","Cookie","sagaTask","toPromise","props"],"sourceRoot":""}