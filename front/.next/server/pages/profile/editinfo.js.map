{"version":3,"file":"../pages/profile/editinfo.js","mappings":"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","sources":["webpack://react-social-app/./pages/profile/editinfo.tsx","webpack://react-social-app/external commonjs \"@ant-design/icons\"","webpack://react-social-app/external commonjs \"axios\"","webpack://react-social-app/external commonjs \"next-redux-wrapper\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/head-manager-context.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/i18n/normalize-locale-path.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/is-plain-object.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/mitt.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/page-path/denormalize-page-path.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router-context.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/format-url.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/get-middleware-regex.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/is-dynamic.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/parse-relative-url.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/querystring.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/resolve-rewrites.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/route-matcher.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/router/utils/route-regex.js\"","webpack://react-social-app/external commonjs \"next/dist/shared/lib/utils.js\"","webpack://react-social-app/external commonjs \"next/router\"","webpack://react-social-app/external commonjs \"react\"","webpack://react-social-app/external commonjs \"react-redux\"","webpack://react-social-app/external commonjs \"react/jsx-runtime\"","webpack://react-social-app/external commonjs \"redux\"","webpack://react-social-app/external commonjs \"redux-devtools-extension\"","webpack://react-social-app/external commonjs \"redux-saga\"","webpack://react-social-app/external commonjs \"redux-saga/effects\"","webpack://react-social-app/external commonjs \"tailwind-styled-components\"","webpack://react-social-app/external module \"immer\"","webpack://react-social-app/external module \"react-hook-form\""],"sourcesContent":["import React, { useCallback, useEffect, useRef } from \"react\";\r\nimport Layout from \"../../components/Layout\";\r\nimport tw from \"tailwind-styled-components\";\r\nimport LogInForm from \"../../components/LogInForm\";\r\nimport Input from \"../../components/Input\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../../reducers\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport {\r\n  avatarEditDeleteAction,\r\n  avatarEditRequestAction,\r\n  avatarSetAction,\r\n  editInfoRequestAction,\r\n  myInfoLoadRequestAction,\r\n} from \"../../action/userAction\";\r\nimport { useRouter } from \"next/router\";\r\nimport wrapper from \"../../store/configureStore\";\r\nimport { GetServerSideProps } from \"next\";\r\nimport axios from \"axios\";\r\nimport { END } from \"redux-saga\";\r\n\r\nconst LoginForm = tw.form`\r\n  space-y-4\r\n  px-16\r\n`;\r\n\r\nconst SubmitButton = tw.button`\r\n  text-white\r\n  hover:bg-indigo-600\r\n  hover:font-bold\r\n  border\r\n  p-2\r\n  px-4\r\n  mt-8\r\n  rounded-md\r\n  bg-indigo-400\r\n`;\r\n\r\nconst InputHead = tw.div`\r\n  text-sm\r\n  text-gray-500\r\n  text-start\r\n`;\r\n\r\nconst PreAvatar = tw.img`\r\n  rounded-full\r\n  w-16\r\n  h-16\r\n`;\r\n\r\nconst Avatar = tw.img`\r\n bg-slate-500\r\n  w-16\r\n  h-16\r\n  rounded-full\r\n`;\r\n\r\nconst InputAvatar = tw.input`\r\n  hidden\r\n`;\r\n\r\nconst AvatarButton = tw.div`\r\n  cursor-pointer\r\n  text-sm\r\n  text-gray-500\r\n  hover:text-indigo-600\r\n  hover:font-bold\r\n  border-2\r\n  rounded-md\r\n  p-2\r\n`;\r\n\r\ninterface ValidForm {\r\n  nickname: string;\r\n}\r\n\r\nfunction editinfo() {\r\n  const router = useRouter();\r\n  const avatarInput = useRef<HTMLInputElement>();\r\n  const { me, avatarPaths, editDone } = useSelector(\r\n    (state: RootState) => state.userReducer\r\n  );\r\n\r\n  const { register, handleSubmit, setValue } = useForm<ValidForm>();\r\n  const dispatch = useDispatch();\r\n  const onClickAvater = useCallback(() => {\r\n    avatarInput.current.click();\r\n  }, [avatarInput.current]);\r\n\r\n  const onChangeAvatar = (e) => {\r\n    const avatarEditFormData = new FormData();\r\n    [].forEach.call(e.target.files, (file) => {\r\n      avatarEditFormData.append(\"avataredit\", file);\r\n    });\r\n\r\n    dispatch(avatarEditRequestAction(avatarEditFormData));\r\n    e.target.value = \"\";\r\n  };\r\n\r\n  const onClickDeleteAvatar = () => {\r\n    dispatch(avatarEditDeleteAction());\r\n  };\r\n  useEffect(() => {\r\n    if (me) {\r\n      if (me.nickname) {\r\n        setValue(\"nickname\", me.nickname);\r\n      }\r\n      if (me.avatar) {\r\n        dispatch(avatarSetAction(me.avatar));\r\n      }\r\n    }\r\n  }, [me]);\r\n\r\n  useEffect(() => {\r\n    if (!me) {\r\n      router.replace(\"/\");\r\n    }\r\n  }, [me]);\r\n\r\n  const onValid = ({ nickname }: ValidForm) => {\r\n    const formData = new FormData();\r\n    formData.append(\"nickname\", nickname);\r\n\r\n    formData.append(\"avatar\", avatarPaths);\r\n\r\n    dispatch(editInfoRequestAction(formData));\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (editDone) {\r\n      router.push(\"/profile\");\r\n    }\r\n  }, [editDone]);\r\n\r\n  return (\r\n    <Layout>\r\n      {me ? (\r\n        <>\r\n          <LogInForm headTitle=\"회원 정보 수정\">\r\n            <LoginForm\r\n              onSubmit={handleSubmit(onValid)}\r\n              encType=\"multipart/form-data\"\r\n            >\r\n              <div className=\"flex items-center space-x-3\">\r\n                {me?.avatar !== \"null\" ? (\r\n                  <PreAvatar src={`http://localhost:4000/${me?.avatar}`} />\r\n                ) : (\r\n                  <Avatar />\r\n                )}\r\n\r\n                {me.avatar === \"null\" ? (\r\n                  <AvatarButton onClick={onClickAvater}>이미지</AvatarButton>\r\n                ) : (\r\n                  <AvatarButton onClick={onClickDeleteAvatar}>\r\n                    초기화\r\n                  </AvatarButton>\r\n                )}\r\n              </div>\r\n              <InputAvatar\r\n                name=\"avataredit\"\r\n                type=\"file\"\r\n                ref={avatarInput}\r\n                onChange={onChangeAvatar}\r\n              />\r\n              <InputHead>Nick Name</InputHead>\r\n              <Input\r\n                register={register(\"nickname\")}\r\n                type=\"text\"\r\n                placeholder=\"Name\"\r\n              />\r\n\r\n              <div>\r\n                <SubmitButton>수정하기</SubmitButton>\r\n              </div>\r\n            </LoginForm>\r\n          </LogInForm>\r\n        </>\r\n      ) : null}\r\n    </Layout>\r\n  );\r\n}\r\n\r\nexport const getServerSideProps: GetServerSideProps =\r\n  wrapper.getServerSideProps((store) => async (context) => {\r\n    const cookie = context.req ? context.req.headers.cookie : \"\";\r\n    axios.defaults.headers.common.Cookie = \"\";\r\n    if (context.req && cookie) {\r\n      axios.defaults.headers.common.Cookie = cookie;\r\n    }\r\n\r\n    store.dispatch(myInfoLoadRequestAction());\r\n    store.dispatch(END);\r\n    await store.sagaTask.toPromise();\r\n    return {\r\n      props: {},\r\n    };\r\n  });\r\n\r\nexport default editinfo;\r\n","module.exports = require(\"@ant-design/icons\");","module.exports = require(\"axios\");","module.exports = require(\"next-redux-wrapper\");","module.exports = require(\"next/dist/shared/lib/head-manager-context.js\");","module.exports = require(\"next/dist/shared/lib/i18n/normalize-locale-path.js\");","module.exports = require(\"next/dist/shared/lib/is-plain-object.js\");","module.exports = require(\"next/dist/shared/lib/mitt.js\");","module.exports = require(\"next/dist/shared/lib/page-path/denormalize-page-path.js\");","module.exports = require(\"next/dist/shared/lib/router-context.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/format-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-middleware-regex.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/is-dynamic.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/parse-relative-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/querystring.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/resolve-rewrites.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-matcher.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-regex.js\");","module.exports = require(\"next/dist/shared/lib/utils.js\");","module.exports = require(\"next/router\");","module.exports = require(\"react\");","module.exports = require(\"react-redux\");","module.exports = require(\"react/jsx-runtime\");","module.exports = require(\"redux\");","module.exports = require(\"redux-devtools-extension\");","module.exports = require(\"redux-saga\");","module.exports = require(\"redux-saga/effects\");","module.exports = require(\"tailwind-styled-components\");","module.exports = import(\"immer\");;","module.exports = import(\"react-hook-form\");;"],"names":["React","useCallback","useEffect","useRef","Layout","tw","LogInForm","Input","useForm","useSelector","useDispatch","avatarEditDeleteAction","avatarEditRequestAction","avatarSetAction","editInfoRequestAction","myInfoLoadRequestAction","useRouter","wrapper","axios","END","LoginForm","form","SubmitButton","button","InputHead","div","PreAvatar","img","Avatar","InputAvatar","input","AvatarButton","editinfo","router","avatarInput","me","avatarPaths","editDone","state","userReducer","register","handleSubmit","setValue","dispatch","onClickAvater","current","click","onChangeAvatar","e","avatarEditFormData","FormData","forEach","call","target","files","file","append","value","onClickDeleteAvatar","nickname","avatar","replace","onValid","formData","push","headTitle","onSubmit","encType","className","src","onClick","name","type","ref","onChange","placeholder","getServerSideProps","store","context","cookie","req","headers","defaults","common","Cookie","sagaTask","toPromise","props"],"sourceRoot":""}